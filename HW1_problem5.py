# def ClumpFinding(Genome, k, L, t):
#     clumps = []
#     for i in range(len(Genome)-L+1):
#         for j in range(L-k+1):
#             pattern = Genome[i+j:i+j+k]
#             if PatternCount(Genome[i:i+L], pattern) >= t:
#                 clumps.append(pattern)
#     return set(clumps)

def PatternToNum(Pattern):
    dna = ['A','C','G','T']
    if len(Pattern) == 0:
        return 0
    symbol = Pattern[-1]
    prefix = Pattern[0:len(Pattern)-1]
    return 4*PatternToNum(prefix) + dna.index(symbol)

def NumToPattern(index,k):
    dna = ['A','C','G','T']
    if k == 1:
        return dna[index]
    prefixIndex = int(index/4)
    r = index%4
    symbol = dna[r]
    prefixPattern = NumToPattern(prefixIndex, k-1)
    return prefixPattern+symbol

def ComputingFrequencies(Text,k):
    freqArr = [0]*(4**k)
    for i in range(len(Text)-k+1):
        pattern = Text[i:i+k]
        j = PatternToNum(pattern)
        freqArr[j] = freqArr[j]+1
    return freqArr

def BetterClumpFinding(Genome, k, L, t):
    freqPatterns = []
    clump = [0]*(4**k)
    text = Genome[0:L]
    freqArr = ComputingFrequencies(text,k)
    for i in range(4**k):
        if freqArr[i] >= t:
            clump[i] = 1
    for i in range(1,len(Genome)-L+1):
        firstPattern = Genome[i-1:i-1+k]
        index = PatternToNum(firstPattern)
        freqArr[index] = freqArr[i] - 1
        lastPattern = Genome[i+L-k:i+L]
        index = PatternToNum(lastPattern)
        freqArr[index] = freqArr[index] + 1
        if freqArr[index] >= t:
            clump[index] = 1
    for i in range(4**k):
        if clump[i] == 1:
            pattern = NumToPattern(i,k)
            freqPatterns.append(pattern)
    return freqPatterns

genome = 'GAGCAGGTCACTCCACTTCTAAGCGCCTCTGACCCGTCTTGTTTGGGCTGACGACGCGTTCAGCCAATGGGTCCAGTCGTCTTGTCAGAATGGGAATCTAAGAGGTCACCACGATCGTACTTTCGACTACCTCGCGATCCAGGTGAGATCAGCGTTTAGTCGTGGCGCGTTGGCGCCTGGCGACATTGAGAGTAACTGGAGGACGTACCCCCTACCGCGTATTGGAGCAGGCCCTTTATAGGAAACGGCGTGCCGTAGGCCCTGTCGCCTATCACCTGCCCGGCATCGGGGCAAGCAGGTGAAGCCTACTGATAACAGCCTTGGCATGTACTCGTTTCAGCGACGTCCTGCTTCTTTCGCAGGCAGACCGGGCGGTAACTATGGACTCACTGAGCTGGGGCTTGATATCTCGTAGACGGGCTTTTTGATATGAATCAGGGATTATACTGCTAATTAAGAGCGGTTTTTGTTTGTAGGCGAAAGAACCGAGCCTATACACTCGGGCGACTCTAGCACGTGACATGGGGATATAATTTCCCCATTAGTATATTGAGGACTCACAAGGAATCCGCTTCTTCAACGTATCGATTGACCATCATTCCGGCTTTCTCGCCGGGTCTCTATGACGGTAGGACATGTGTCGCTTCACGGCCTGGCATAAGTCGATGTCTATGGTTACCGCCGGGCAAAGTCACCATTCAAGGAAGCGGACCAAGAGCCCAAGAGCAGTCTTGTTAGGGTAGCCATAGCGACAATGCTTGGCGCACATTTCCATAGATGACGGCGCGCCTTCCATTACTGTACTCTCGTCTTTGGAACTTGCTCTGAGTGTGTGCTAGCCCGCCACCAGTACTAGTATGAGTACTTCGTTATTTGCGCAGCTGATTCGCTGTTAAACGGGGAGGCTTACGGGATAAACGAAGAGTTTGTAGCTAGAATGCGAATAAGAATTCTTGTGTAGTTTACCAGATAGCTGGAACAGCTTGGGGCTTATGTCTATATGTGACAAAGCTTAGCCAGCCTGCAGCGCTGCCAGGGACCTCAATGATGACTCAGGACATGCCTAAGTATTAACGGTTTCGCTGCACTCGATCCTTGCGTAGCCGGGCACGGGCCCTCGGCGAGGACCGGCGAGGACCGGCGAGGCGGCGAGGACCGTAAAACGGCGAGGACCCCATGTCATACGGCGAGGACCCGGCGAGGACCCAATCGGCGAGGACCCCGACCGAGCACTTATGACACGATCAGCGCGACGATCAGAGTTTCAGGCTGTTCGACGGCGAGGACCTCAACAAGAGGCCTGGGAATCGCGGCGAGGACCGGACCCTTAGGTACCGCGGCGAGGACCGTCGGCGAGGACCCTCGCGGCGAGGACCGTGCATTGAACGGTACTAATATGAGGGCGGCGAGGACCGACCTCGGCGAGGACCGGCGAGGACCCCCGGGCTCGGCGAGGACCTTTGCTGTGAATAGCTGTGAATAGCAACCTGTGAATAGCAAGCAGGACCTATCTGTGAATAGCAGAATAGCAGACCCGCAGGTCTGTGAATAGCACCGTGTGATGTTGTGATGTGAATAGCAGGTGTGAATAGCATAGTCCTCCGGCGAGGATGTGAATAGCAGCACAGGTCCGGCTGGCCAGGTCCGGCTGTGAATAGCACCCAAGAATCTAACTGTGAATAGCAGGCAGGTCCGTGTGAATAGCAGAATAGCAGTCCGGCTCAGGTCCGGCTGGCCTGCCAACCAAACATGCGGTGAATAGCATGGCCAAACATGCGCATGCGCGGCTCCAGGCCAAACATGCGCGATGCGCCCAGGTCCGGCTCCGCTATTGTGAATAGCCCAAACATGCGATGCCAAACATGCGAAACATGCCAAACATGCGATGTGAATAGCCAAACATGCGGTGAATAGTGTGAACCAAACATGCGAAGTATTGTGAATAGCATAGTGTTAAGACCCAAACATGCGGCGAGGTCCGGTGTGAATCCAAACATGCGCCGGCTGGGTCTGGTGATTACCACCAAACATGCGTCCGGCTGGTCCAAACATGCGGGGTCTGGTGATTTGACCCGAGGAAGTCCCCAAACATGCGGTCCGGGGTCGCCGAGGAAGTCCCGCGCCAAACATGCGCCAAACATGCGGCCAAACATGCGCACCAAACATGCGGTCCAAACATGCGCCAAACATGCCAAACATGCGGGGGAAGTCGGGTCTGGTCCAAACATGCGTCGTGCAGGACAGTCCGAGGAAGTCTTTCCGGCCCGAGGAACCAAACATGCGAAACATGCGCGAGGAACCAAACATCCAAACATGCGCGAGGAAGTCATTCCGACCGAGGAAGTCTGGTCCCGAGGAAGTCTCTGGTTCGGGGTCTCCGAGGAAGTCCAGGACTCTGCGGGGTCTCCGAGGAAGTCGGGCCGAGGAAGTCGACCGAGGAAGTCTTGAACCCCCCGAGGAAGTCCTGGTGAAAGTGCCCGAGGAAGTCCGAGGAAGTCAAGACCTCGCCGAGGAAGTCTGGTCGGGGCCGAGGAAGTCGTCAAGTGGTCCGGGGTCTGGTTCTCCGAGGAAGTCGAGTCCGAGCCCACGAAATCTAGCCTGCCGAGGAAGTCTAGGATGTACATCAACCCAAGTCCGGTGCTATAGTCACAGGATCGGGTGGGGCTAGGCTGTCGACGGTCCTCCAGTAAGAAAGGCCGGCTCGTCCGCTCGTCCACGAGCCGGCTCGTCCTCCCGGCTCGTCCAAAACATGTGATCAGCCGGCTCGTCCCTGAGAACCGGCTCCGGCTCGTCCGACTTCGTAAGCATCTGTTGACACATTGCGGCACCGAGGACAACCGGCTCGTCCCGGCTCGTCCCGGCTCGTCCCGCACTGCCGGCTCGTCCTTACCGGCTCGTCCAAATGGAATCCGCCGGCTCGTCCTCCCGGCTCGTCCGGCTTGCTTGGTCGTCTGCGGATGCAGAAGCCGGGATCTATGTTCAAATAGGCACCGGCTCGTCCGGCTCGTCCTATCACCGGCTCGTCCGGCTCGTCCAGGGAATCAACCAGTCGCTCTCAAGTTCCGCCGGCTCGTCCCCCCCATCACAGTTACAAGCGCCGGCTCGTCCAGGGTGATCCTCTGGGAACTTGGCGCGACCGGCTCGTCCCCCCGGCTCGTCCGGCTCGCCGGCTCGTCCCGGCTGTCCGGCTCGTCCGATTGGCTAACGGTTCCTCGTCCTCCGCTAACGGTTCGGGGCGCTAACGGTTCGTTGATGTCCGGCTCGCTAACGGTTCTAACATAACCCAGCGCTAACGGTTCGGTCTTCGCCTCCGCCGCGCTAACGGTTCGCTAACGGTTCTTCATCCTTGATGTTGAAGTCCCTATCCTATTGACTCTTTCATACGCTAACGGTTCCGCTAACGGTTCAGCTAACGGTTCAACGGTTCTCTCATTATGCCGATATTGGAGGAAACGACTCAACCGCTCGTCGTTGACCCTAACGAAGACCGCTAACGGGCTAACGGTTCGCTAAAGGCTAACGGTTCGGTTCTACAAAGGGCTAGCTAGCTAACGGTTCCAGGGTACGCGTGCGCACATAAGTAGTGTGGTTTGGCTAACGGTTCGACATGAATCATAAGGCTAACGGTTCTCGTTCACTATGTTCACCTTATGGCTAACGGTTCACAATCTCTCTGCTAACGCTAACGGTTCCTCCGCTAACGGTTCCTAACGGTTCCTCTCCCGTAGCTAACGGTTCTAGCTAACGGTTCGTCCAGCTAACGGTTCGAATGAGAGAAGCACAAAGCATCGCAACGAATCCTGTCCCATCAGTCCTGGTGGAGGTGCGTGTAATACAACGTATGGGGACTAGAAAGCTAATGGGATGAACTCGTGTTGGCAGGGGTCGTGCGAGGCTGTCGTAGAGCATGAGGTCCGCGGAAATGGGCAAGCGGGTCACAAGAATCCGTGAATTAAAGAAGGACAGCTCTTACGTGTGTGGAATTTGATAATACTAATATCACGACCTACTCGATTACGGGCAGTCATTTTTACAGACAACCATAGAGCTGCCTATTATGGAGCTGCTGAGAGGAAAAAGTACAGGTTATTGCGGTAGGTGTTGACGCTCACGGGGAATGAGGAATTGGTCAAACCCTAAGAACAGCTCGAGCCCCCCTCACCGTGCATTCCTCCCTTATGGATCGTGTAACGATATGGAGTGGTGTTCTTGACTTGGATACCTTTATAGTGTGAGGACAAAAAACCAAATGATACTGTTGTAGAACTAACCATGCTTGCATGAACATAACTGAACAATGACCGGTGTGCAGCCCCTTCAGTTATGGTTCTGAGGACGTCAGAATCGACCTCGGTGTTTCTCGGCAACAGCTTCGTCAAAGCTTTGGTGATGCGTTTCATAGCCTACCATGCGACGGCATTTGGGTATGGCAAGGGAACGACGCGGTTTCAGACGAGCACCGCGGAAAAAACATAGCTACGCGCAAGGAATCGATTGACTGTCAAGCCACTTTCTCTATAGGAAGGCGTCAGTAAAAAGACACCTACGATTGCCTTAGTACGTCTTCGGACTGCGCCCGGCAATAGACCAGGGTAGACGATATGCACAGCGGCTTCAAACCAGCCAAGTCGAATCGCGGCTCTACAGGACGACGAATTACTTCGACTGCTCAATGCTCATCCTGGCATACTTGGTGGAGCGTACTATATTGACGTTGACTACTAATATATGAGTTATCTGGTAAGATCCTATACGCTTTCGAATGACGCGTGTCACTGCCCACATGACGCGTGTATGACGCGTGTAAATGGTAAACGCCCATGAGATGACGCGTGTGACGCGTGTCACGCATGACGCGTGTGGAGTATGACGCGTGTGCTTCGATAAGCGTGTGGTACATGACGCGTGTACATGACGCGTGTGGATGACGCGTGTATGACGCGTATGACATGACGCGTGTGTAATGACGCGTGTTCCCAATCGGCTGTTACCCCTCCCAATGAATGACGCGTGTACGATGACGCGTGTGCGATGACGCGTGTCTTATGACGCGTGTAGAACCGGCTCGTATAAACTCCAATTATGACGCGTGTCAGCTAGCTATGGAATGACGCGTGTGCATGACGCGTGTGTCTGGGGCACTCATGACGCGTGTATGACGCGTGTTAAAGGTCCCAAAAGACGTGGTGAGTGGGGATCCGTATCTTAGATAGGCACCCGTTTCCCCAATAGACATGACGCGATGACGCGTGTATGACGCGTGTATTATGTTCATGACGCGTGTACGCGTGTAAGGTCAATGACGCGTGTCCTAATTCGATGACGCGTGTCATTGCTCAATGTAGGTCTTGATAGTCCCTGCGTACACGGATAGGGCGTACACGGAGTGACTATGTGGGTGTCCCCAGCGTACACGGAAGTTCAGCGAGTGATACATCTAGCGTACACGGACTGGCAGAGCCTAACAATCTGCTGCCGCGTACAGCGTACACGGACGTTTTCATGGGCGTACACGGAATGCGTACACGGACGTTGCAAAATGAGGGAAGGAGTGACCCAGAAGGACTAAACGGCGTACACGGAGGATTACTTTCGGGCGTACACGGAGAGGCACAAGGCTCAGGCGTACACGGAGTGGACTCCTGCGTACACGGATAAGCTCACAGTAGCGTACACGGAGAACGGAGTATCAAGCGTACACGGAAGCGTACACGGCGTAGCGTACACGGAAGCGTACAGCGTACACGGAACAAATTGGTATGCTCAAACAAATTGGTATGGCGTACACGGAGCGTACACGGACAAGCGTACACGGATCAGCGTACACGGACGCGTACACGGATCAGGCGGGCGTACACGGAATGTATTCTGTGCGCGTACACGGAGGTATTCGATGGTACACACAAATTGGTATTGGACGCCGCAAAGCGTGCGTACACGGATTGGCGTACACGGACCTTCATCTCATTGCCTTCATCTTGCCTTCATCATCGCACCCTTGCCTTTGCCTTCATCTCATCTCATCGACGTGAGCGGCAAATTGGTTTGCCTTCATCAAGACCGTTGCCTTCATCCGTTTGCCTTCATCATGATGTTGCCTTCATCTCATCCGTGAGACGTGATTATTGCCTTCATCGATGGTATATAACCCGCGAAGACGAAGACTTGCCTTCATCACGTGATTGCCTTCATCGAAGACGTGATATCAGTCAAATTGGTATGCGTGAAACCGAAGACGTGACTCAATTTTGCCTTTTGCCTTCATCCAACTTTTTGCCTTCATCTGTTGAAATGGAACCTTGAAATGGAACAGGCTCCGAAGACGTGACTTGCCTTCATCCACCATTGAAATGGAACAAATGCGAAGCGAAGATTGCCTTCATCCTTGCCTTCATCAACTTGCCTTCATCTCGAACCGCATCGAAGACGTGAGGACTTGCCTTCATCAGTTCGCCGATTAGTTGCCTTGCCTTCATCCTGTTGCCTTCATCCTTCATCTTCATCAGACGTGATTTTGCCTTCATCACCGAACGAAGATTGCCTTCATCATGGAACATGGCGAAGACGTGAGACGCGAAGACGTGATGAGTGAAATGGAATGAAATGGAACGCTCTACAATCGCGACCGGGTCTTCTCAAGTATTTGTGAAATGGAACTGGAACATTTGAAATGGAACTTGGTACGTAGAGCCGGTCATCCGAGTTTGATAGGTCTTGTGACTGATACCGGCGAGTCCGGGATGGCGGACTACCGAGTGATACGAGTGCGTGGAAGTCTTGCATTGTACTGATTCATGAGAAAGTGTACCTATTTGTGTGAGCAGCCCATGCGACTCGCCTGTAAAAAAGTCCACTACGGCTACAGGGTGAGATCGAAGGGCGAAGGGTTTCACCACCGCCTCAATCACCCCTCAATCCTCAATCACCAGCCTCAATCACCATCGAGATCGAAGGGCCAAGGACCTCAATCACCCGAAGGGTGCCCTCAATCACCAATCACCGCCCTCAATCACCAGATCGAAAGATCGACCTCAATCACCACGCTAGCCTCAATCACCGAGATCGAAGATCGAAGCCCCTCAATCACCGATCGAAGGGGGAGTTAGATCGAACCCCTCAATCACCGTCCGTGCGTTGTTCCTCAATCCCTCAATCACCCCTCAATCACCACCGCCCAGATCGAAGGGGAGGTATGATGGGGGCCTCAATCACCTCTCCTCAATCACCACCAGCAGATCGAAGGGTTCAGATCCGGGATGAAGCCCCCTCAATCACCAGATCGAAGGGGAACCCTCCTCCTCAATCCCTCAATCACCAATCACCCTCAATCACCTCACCTCAATCACCTCACCGACCTCAATCACCAGGCAGCAGCAATAGATCGAAGGGCAGGGACCTCAATCACCCTCAATCACCTCCCAGATCGAAGGGGCAGCTGTTAGCGCATTAACCTCAATCACCTCAATGCCCTCCTCAATCACCTGAGTCATGTCTTGCGGCCTATAACCCTGTCCGGTCCGCATGATCCCCCATACCTCGGATTCCCAGAGTGAAAAGGGCGTGTCATACTGTTTAGAACACAATCATAAGGTCAGGTTCCCAGCGCACAATTGAGGTCAGGTTCCGTAGACTGTGGTCAGGTTCCCCCGGGTCAGGTTCCACGGGTTTGGAGCGTGGTCAGGGGTCAGGTTCCGTGGGTCAGGTTCCCATGGTCAGGTTCCGTAGTTGTAAAATTGGTCTCGTATACACCGAGGTCAGGTTCCCAGGGTCAGGTTCCAGCTGTGTCCCGTGTGCACTGGGTGGTCGGTCAGGTTCCGGGTCAGGTTCCCGGTCAGGTTCCGGTCTCAGTTCACAGGTCAGGGTCAGGTTCCATCATAAGTCTTAGGTCGATGGAACGGTCAGGTTCCTAATCTTTAGCTGGTCAGGTTCCAACCGCGGACGAATTAAGTTGAACCCCGCCTAGGCTTCACAACAAGGTCAGGTCAGGTTCCCTGGGAAAGGGGTGGTCAGGTTCCGCAACGTGTGTCTTCGCCATAGGTCAGGGTCAGGTTCCCAGGGGTCAGGTTCCTCAGGTTCCGATCCACCTTGCTCCCGTATGGGTCTCTTCCGGGTGGGGGTCAGGTTCCTAGAACGGCATAAGTTCGCCCTGGTCGGTCAGGTTCCCGGCGGGTCAGGTTCCCTCCACCGAGCCTCCTGAAGAAGTCTCCCCGTCGGATACAACCTATCCAGCGCCAGCCTCTGATGGTGAATTCGTGATTGACTTGAGGCGAAAGTCAGCGGGGTTGGCTTGCGTAGGTCTTTTGAGTATTTCCGTCATCGTCCCGGGCCCTTCGCTTGAGCGACATAAAGCAAGGTAATTCATCTTGTGATCTGGCGGTATCGCTAACTCGTAGGTCACATTTAGAACTGTACTACCGGCAAAGAGGTCAACAACAGGACTGCCCACGTCTGATCCACTGATCAGCCTAAAGTTCTGTGCCTGCAGGGCATGAAACGGCTCATTCCCACCTGGCTTACGGTCGGGCCGCACAAGTCATTGTTGTTGTTGACAGGCAGGGATCGCTTGTTGACAGGGCACGAGGAGGATTCTTGTTGACAGGAATCAGAGAGGTTAGATGAGACTGCCCCAAGACACGTGAGCGAATAGCGTTTTGTTGACAGGGTTGACAGGCTTAGCATTGTTGACAGGAATTGTTGACAGGAGACAACATGTAGTCCTTCTTGTTGACAGGCTTCTCGGTTCTAAATTGGGCACATGATCCCCATACTTTTGTTGATTGTTGACTTGTTGACAGGGAGCTATTGTTGACAGGGGCCTTGTTGACAGGTGGTTTTGTTGACAGGAGGAGATATTTGTTGACAGGCACTCATTGTTGACAGGGTTGTTGTTGTTGACAGGATATTAATACTTGTTGACAGGGGACGTACAGAAATTCGCTCGTTAACTTGTTGACAGGAGGTCGTGATATACACCTTGTTGACAGGACTTGTTGACAGGTATTGAAAAATCTATTTGTTGACAGGGACAGGTTCGCATTTGTTGACAGGGCGACTATATACATATATATACCTATATACATATATATACTTGTTGACAGGGCACTGTCGGTCTATTGTTGACAGTTGTTGACAGGCATAATACATATACGGTGGAGCTGTGCTTCACACACTTTATCCCAGCTGAGATCTATATACATATTTGGTTCACAGTCGAATGACACCTATATACATATATACATAAGGCATCTCGTCGCCTGATCTACTTATGGTCTATATACACTATATACATATATATACATAGGTTTACTTATGGTTTACTTATGGTCTATATACATATTACTTATGGTTTACTTATGGTTTACTTATGGTTTACTTATGGTTTACTTCTATATACATAATAATATACTTCTATATACATAATGGTCTATATACATACTATATACATATATACATATACTTATGGCTATATACATAATGGTTTACTTTACTTATGGTTATGGTTTACTTATGCTATATACATAGTTTACTTATCTATATACATAATATACATATACTATATACATAGGTTTACTTATGGTTTACTCTATACTATATACATATATACATAATATGGTTTTATGGTT'
BetterClumpFinding(genome,11,563,19)

